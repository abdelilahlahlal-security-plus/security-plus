"use client";

import { useState, useMemo } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { MapPin, ArrowRight, Shield, Activity, Users } from 'lucide-react';
import Link from 'next/link';
import clsx from 'clsx';
import { useTheme } from 'next-themes';
import type { SanityDepartment } from '@/lib/sanity';

type InteractiveMapProps = {
    departmentStats?: SanityDepartment[];
};

// Departments - Aquitaine South/West focus
const departments = [
    {
        id: '33',
        name: 'Gironde',
        // Extracted ID 1
        path: 'M663.4,319.2 L663.2,317.1 L660.9,313.8 L660.2,307.4 L655.3,299.2 L650.9,297.4 L642.9,296.8 L639.9,296.0 L632.5,297.8 L625.5,305.2 L623.1,303.6 L622.0,304.5 L619.2,303.6 L612.6,293.9 L608.5,294.3 L604.9,296.4 L594.0,307.4 L590.9,307.8 L588.1,306.1 L578.7,304.8 L573.0,302.0 L569.4,298.5 L561.6,297.9 L558.0,294.9 L554.4,286.2 L552.9,285.6 L552.6,282.5 L542.4,278.3 L540.3,283.7 L537.6,274.7 L532.8,270.3 L525.1,268.2 L519.9,274.1 L517.6,281.3 L518.0,280.1 L513.6,263.6 L512.7,258.9 L508.2,252.2 L507.9,249.2 L512.6,235.0 L511.5,232.3 L507.0,231.9 L510.0,223.4 L509.2,220.5 L504.6,217.2 L492.3,210.7 L488.1,210.6 L479.1,213.4 L472.4,210.4 L468.0,209.9 L465.9,208.2 L462.0,207.6 L459.3,198.8 L460.3,201.5 L462.3,192.1 L457.2,186.7 L454.2,191.7 L453.9,196.5 L449.7,195.0 L441.3,197.1 L438.6,198.6 L436.0,195.0 L417.6,191.9 L416.1,191.7 L415.5,193.2 L419.7,211.5 L421.5,233.5 L406.0,236.1 L403.1,237.0 L397.8,210.8 L387.6,183.0 L385.5,180.8 L381.7,174.6 L364.7,157.2 L356.9,152.4 L348.4,137.6 L334.0,128.3 L322.5,116.8 L319.2,112.0 L313.1,108.1 L306.9,101.2 L306.9,95.4 L310.9,95.1 L312.6,96.3 L309.7,91.8 C310.9,91.70000000000005 312,91.70000000000005 313.2,91.59999999999991 L315.6,94.8 L316.8,93.1 L315.4,88.0 L311.8,86.4 L308.8,81.8 L310.7,75.0 L307.6,76.7 L300.8,78.9 L297.3,88.0 L291.6,95.7 L284.8,102.3 L278.6,115.1 L277.8,121.2 L278.7,132.3 L274.8,149.3 L274.1,172.1 L270.6,203.9 L245.8,368.2 L224.6,487.2 L223.6,498.5 L225.1,503.0 L226.5,503.7 L228.9,501.8 L230.1,495.4 L229.3,492.4 L232.6,476.7 L235.7,469.2 L239.2,463.7 L253.6,448.6 L254.8,445.7 L253.9,441.0 L259.3,435.3 L262.8,440.4 L269.6,446.4 L273.6,444.4 L271.6,446.7 L272.9,449.5 L278.3,452.4 L285.1,460.5 L297.8,474.0 L289.1,473.6 L292.9,478.3 L301.5,481.8 L303.3,486.1 L303.0,487.6 L306.8,492.3 L307.2,495.3 L302.7,495.3 L303.3,498.2 L295.5,493.4 L294.4,494.5 L281.2,497.2 L272.2,495.0 L270.2,496.9 L269.7,494.1 L268.2,493.8 L263.7,493.6 L259.9,496.0 L258.8,495.1 L258.9,493.6 L262.8,491.4 L261.3,487.2 L255.1,485.7 L248.8,486.0 L246.2,487.6 L242.3,496.3 L241.5,507.4 L238.4,514.8 L231.6,527.5 L222.0,538.1 L224.0,555.5 L222.0,573.0 L240.0,568.5 L270.6,559.7 L278.4,546.6 L295.8,558.3 L308.4,557.4 L309.6,560.3 L311.1,569.8 L306.9,580.2 L301.3,591.3 L294.0,597.2 L312.9,595.2 L330.3,589.7 L333.4,593.1 L353.9,602.1 L365.0,601.8 L370.4,598.6 L375.0,598.8 L375.9,594.1 L377.3,593.4 L392.8,590.8 L401.9,593.4 L406.2,593.4 L408.2,591.2 L407.2,590.0 L409.3,587.6 L410.9,587.6 L421.2,591.5 L424.8,594.4 L424.8,610.2 L419.6,613.5 L442.3,622.8 L445.5,626.4 L455.7,631.4 L458.7,643.1 L470.8,650.0 L486.3,651.9 L486.6,661.4 L495.2,668.3 L501.3,669.0 L496.2,690.9 L497.8,703.8 L503.2,705.1 L523.5,707.7 L535.4,712.4 L552.0,707.7 L551.4,685.5 L552.3,680.9 L558.6,681.4 L562.5,678.8 L564.0,679.5 L568.3,684.3 L571.1,691.8 L579.3,699.4 L584.3,696.0 L585.3,693.2 L587.1,695.6 L591.1,697.4 L596.6,694.6 L601.8,689.0 L603.9,691.2 L608.6,682.7 L615.1,679.2 L612.5,670.4 L615.1,668.9 L608.2,658.5 L599.3,649.7 L601.8,642.4 L604.8,642.8 L608.3,639.9 L615.8,639.7 L618.2,640.2 L622.7,635.8 L625.7,635.0 L632.5,637.8 L634.8,633.9 L631.5,630.9 L634.2,627.5 L630.4,623.7 L624.8,613.1 L627.0,611.3 L626.4,607.0 L628.0,603.0 L630.6,602.1 L631.2,598.0 L628.4,594.8 L625.5,595.1 L624.6,581.5 L625.0,574.7 L630.3,568.3 L631.9,567.1 L633.5,567.2 L636.1,563.5 L630.6,553.5 L637.5,558.5 L641.4,554.4 L643.2,552.9 L653.1,556.0 L658.1,547.2 L659.1,542.8 L658.1,540.0 L667.3,537.5 L669.4,535.8 L669.7,535.7 L675.0,530.4 L680.8,529.5 L682.0,526.8 L677.4,521.0 L676.9,516.9 L678.2,514.6 L681.1,518.2 L685.8,518.7 L687.0,512.7 L692.0,506.0 L690.1,503.4 L687.2,502.6 L685.8,501.6 L678.9,503.5 L676.2,502.4 L675.5,499.8 L676.7,495.9 L670.5,495.7 L667.8,494.2 L666.0,487.0 L667.5,486.7 L668.1,483.7 L670.9,482.4 L673.8,483.0 L675.9,485.3 L677.7,482.8 L679.8,471.0 L683.4,474.1 L688.7,471.9 L689.9,472.6 L692.6,467.8 L693.9,466.2 L695.5,466.5 L697.0,469.2 L699.0,478.5 L704.7,476.8 L702.6,470.8 L705.0,463.3 L707.2,461.2 L707.8,459.9 L710.8,459.9 L713.6,465.1 L716.4,466.4 L722.2,465.3 L730.4,462.9 L730.7,461.5 L725.3,455.8 L723.5,451.5 L723.8,446.1 L721.3,438.3 L720.8,432.0 L726.6,433.4 L729.9,430.5 L732.8,431.1 L733.0,426.9 L737.7,423.9 L729.3,415.6 L725.2,413.4 L719.1,413.3 L713.5,411.0 L714.9,416.7 L714.2,417.9 L707.7,423.3 L703.6,424.6 L697.8,433.8 L695.1,432.4 L694.5,431.7 L683.7,429.5 L675.8,429.7 L672.3,433.5 L670.8,433.1 L669.8,427.2 L666.6,427.2 L662.4,427.8 L659.3,434.5 L660.0,433.0 L658.4,433.1 L655.1,430.0 L652.0,430.5 L651.0,430.4 L648.3,428.8 L648.4,424.3 L643.2,418.8 L638.8,420.2 L625.0,416.8 L625.6,415.4 L633.0,413.7 L636.9,406.4 L636.9,406.3 L638.1,403.7 L640.7,402.4 L642.0,398.3 L642.3,398.1 L648.1,389.1 L643.2,383.0 L639.3,374.6 L641.0,367.2 L642.8,363.0 L642.6,360.0 L644.0,359.1 L646.6,360.9 L648.1,360.6 L651.4,353.6 L650.4,344.1 L651.6,339.6 L652.1,340.6 L653.7,334.5 L657.3,331.8 L663.4,319.2 Z',
        fill: '#1e3a8a', // Dark Blue
        stats: { clients: 150, agents: 45, sites: 80 },
        x: 480, y: 394
    },
    {
        id: '24',
        name: 'Dordogne',
        // Extracted ID 0
        path: 'M978.3,97.5 L979.5,93.2 L975.1,84.9 L966.3,82.2 L964.3,84.6 L962.3,86.2 L959.8,85.8 L958.0,83.2 L954.8,83.6 L950.5,81.9 L941.6,84.9 L937.1,84.5 L935.2,87.0 L933.7,86.7 L929.8,82.2 L928.5,78.0 L926.2,76.2 L923.0,80.8 L919.4,89.8 L916.3,95.1 L907.1,97.3 L905.6,88.6 L904.1,88.2 L896.4,89.7 L893.5,84.0 L888.2,78.2 L892.7,71.7 L896.9,55.3 L896.3,55.3 L892.1,53.7 L887.1,45.7 L880.2,42.6 L877.3,42.9 L873.8,45.6 L871.2,44.1 L867.2,45.6 L861.0,45.3 L858.4,43.6 L857.4,40.6 L853.5,38.5 L851.1,32.7 L848.8,38.4 L844.2,42.7 L842.9,41.7 L841.9,47.4 L840.0,49.5 L841.2,51.9 L837.2,53.6 L836.8,56.6 L830.3,60.0 L832.8,65.7 L829.2,68.5 L824.8,68.5 L820.9,70.8 L820.1,64.4 L817.1,64.8 L812.7,69.3 L811.2,73.8 L810.2,75.0 L808.6,74.6 L808.9,76.5 L812.6,81.1 L813.3,84.0 L812.0,86.4 L813.2,89.1 L807.2,99.4 L809.6,101.3 L809.6,104.2 L807.1,108.0 L802.0,111.0 L798.9,111.1 L796.4,110.5 L793.7,116.8 L791.0,117.5 L791.3,119.9 L789.8,121.6 L785.3,127.4 L784.7,134.7 L782.0,135.4 L777.4,131.6 L767.7,134.8 L767.3,137.8 L762.7,138.7 L760.5,142.7 L753.4,145.2 L753.3,145.3 L751.4,152.6 L745.7,145.5 L743.1,145.4 L743.1,151.5 L747.1,156.0 L743.0,157.5 L738.7,157.1 L734.8,159.4 L732.4,163.2 L729.5,173.1 L726.2,180.3 L724.7,188.1 L726.9,192.9 L729.0,201.3 L729.2,201.4 L730.7,210.6 L729.1,218.1 L724.5,221.7 L722.6,221.5 L718.6,220.2 L714.4,221.1 L708.6,232.9 L701.9,234.3 L699.2,233.6 L699.6,236.1 L698.2,237.9 L697.4,241.0 L698.7,243.6 L693.1,249.3 L690.0,250.0 L689.0,254.6 L686.1,254.5 L684.6,256.9 L679.4,254.6 L679.0,254.1 L674.6,248.7 L672.0,248.0 L666.8,251.1 L663.7,250.8 L660.3,247.8 L654.0,254.7 L650.2,257.4 L645.5,258.2 L643.3,263.2 L642.3,267.0 L635.3,275.0 L636.8,277.4 L641.5,278.3 L642.2,281.1 L629.3,285.9 L631.3,291.7 L627.2,298.5 L627.5,303.2 L632.5,297.8 L639.9,296.0 L642.8,296.8 L650.9,297.4 L655.3,299.2 L660.2,307.4 L660.8,313.8 L663.2,317.1 L663.4,319.2 L657.3,331.8 L653.6,334.5 L652.1,340.6 L651.6,339.6 L650.3,344.1 L651.4,353.6 L648.1,360.6 L646.6,360.9 L644.0,359.1 L642.6,360.0 L642.8,363.0 L641.0,367.2 L639.3,374.6 L643.2,383.0 L648.1,389.1 L642.3,398.1 L641.9,398.3 L640.7,402.4 L638.0,403.7 L636.8,406.3 L636.8,406.4 L632.9,413.7 L625.6,415.4 L625.0,416.8 L638.8,420.2 L643.2,418.8 L648.4,424.3 L648.3,428.8 L651.0,430.4 L652.0,430.5 L655.1,430.0 L658.4,433.1 L659.9,433.0 L662.4,427.8 L666.6,427.2 L669.8,427.2 L670.8,433.1 L672.3,433.5 L675.8,429.7 L683.7,429.5 L694.4,431.7 L695.0,432.4 L697.8,433.8 L703.6,424.6 L707.6,423.3 L714.2,417.9 L714.8,416.7 L713.5,411.0 L719.0,413.3 L725.2,413.4 L729.2,415.6 L737.6,423.9 L733.0,426.9 L732.8,431.1 L729.8,430.5 L726.6,433.4 L720.8,432.0 L721.3,438.3 L723.8,446.1 L723.5,451.5 L725.3,455.8 L730.7,461.5 L733.7,463.5 L743.0,474.0 L745.4,479.7 L746.2,485.6 L744.8,486.1 L744.0,489.2 L749.6,494.4 L746.5,501.7 L746.0,508.1 L747.8,510.9 L751.5,508.1 L754.7,511.5 L759.2,511.5 L767.6,515.9 L779.1,511.5 L785.3,505.4 L790.9,506.8 L793.4,505.5 L798.8,502.2 L802.0,501.9 L806.0,503.8 L808.3,507.9 L809.9,508.2 L815.1,505.1 L816.6,505.5 L819.9,495.9 L823.6,493.4 L824.8,494.2 L830.3,495.0 L834.0,497.1 L835.2,496.2 L834.7,493.4 L837.5,490.2 L843.2,492.4 L845.5,498.0 L845.9,503.5 L854.9,504.9 L858.5,504.3 L869.1,505.1 L874.7,502.6 L879.2,503.4 L880.4,499.0 L885.2,501.7 L888.0,501.4 L888.6,496.8 L892.2,494.4 L898.1,496.5 L901.5,499.7 L902.3,502.7 L900.5,506.0 L903.5,508.5 L909.0,509.4 L906.4,510.7 L905.8,515.1 L903.2,516.3 L903.2,523.8 L897.0,528.1 L899.5,530.8 L900.8,534.6 L903.6,533.7 L902.6,539.5 L909.8,541.5 L913.8,542.1 L916.1,534.6 L922.3,533.8 L926.3,531.2 L928.9,529.8 L932.8,525.3 L938.3,523.2 L945.6,525.2 L949.1,522.2 L955.1,527.0 L960.2,534.9 L966.9,538.4 L971.3,540.0 L974.4,543.4 L979.1,544.2 L981.2,548.3 L980.1,552.9 L980.5,554.3 L984.7,555.9 L989.2,555.6 L988.1,551.8 L989.3,551.4 L987.1,545.8 L990.9,541.0 L1005.3,528.2 L1006.1,525.1 L1004.1,519.1 L1005.2,518.1 L1004.3,510.9 L1009.0,510.0 L1011.0,507.6 L1015.4,505.8 L1029.7,505.4 L1029.8,504.8 L1031.6,502.3 L1035.8,500.8 L1036.4,496.2 L1041.9,493.9 L1044.8,488.6 L1050.2,492.1 L1054.1,485.9 L1054.8,478.7 L1059.9,480.6 L1061.9,471.2 L1057.6,466.7 L1054.1,463.8 L1056.4,459.9 L1056.0,458.4 L1053.0,458.0 L1055.6,454.5 L1063.6,450.9 L1068.0,451.2 L1073.6,449.1 L1076.1,448.6 L1075.1,437.7 L1076.9,433.5 L1081.0,434.3 L1084.4,431.3 L1088.9,431.8 L1090.0,425.5 L1091.2,424.8 L1091.9,421.2 L1093.7,422.0 L1099.9,421.2 L1101.9,418.8 L1101.3,414.0 L1095.5,410.4 L1094.5,405.4 L1092.0,404.7 L1096.3,400.5 L1102.1,400.4 L1099.5,392.0 L1100.4,390.9 L1099.7,388.0 L1098.2,387.9 L1095.2,382.3 L1095.5,377.7 L1093.8,375.2 L1094.2,366.3 L1092.5,360.3 L1088.1,360.9 L1100.2,358.6 L1105.1,354.8 L1100.9,349.8 L1093.7,339.5 L1092.9,336.3 L1089.9,335.4 L1092.0,331.5 L1087.6,323.4 L1088.2,319.0 L1085.0,316.4 L1084.0,317.4 L1083.4,315.0 L1088.0,315.2 L1093.4,312.3 L1094.9,309.7 L1094.8,306.6 L1084.4,301.5 L1079.9,303.0 L1075.2,302.1 L1075.3,298.7 L1069.4,300.3 L1065.4,298.1 L1061.4,300.5 L1055.6,298.2 L1052.3,294.7 L1044.2,290.4 L1044.4,287.5 L1048.7,287.4 L1053.0,283.4 L1056.3,278.3 L1055.7,276.8 L1050.2,271.1 L1037.8,272.1 L1036.2,269.4 L1038.1,261.3 L1045.6,258.9 L1052.4,252.6 L1052.1,246.3 L1046.0,246.6 L1040.3,243.9 L1041.2,241.3 L1036.5,238.7 L1038.2,231.5 L1040.5,229.8 L1041.5,225.4 L1040.4,224.8 L1041.2,223.5 L1039.8,216.0 L1047.5,216.8 L1052.2,212.7 L1054.8,207.2 L1055.9,202.7 L1060.1,200.4 L1063.2,200.1 L1065.8,198.8 L1067.2,196.0 L1068.4,188.8 L1061.0,183.6 L1055.1,187.7 L1052.8,184.1 L1054.1,181.2 L1049.6,181.6 L1048.4,180.6 L1048.1,174.5 L1050.3,172.7 L1054.8,174.0 L1057.9,173.1 L1057.7,165.7 L1052.7,163.9 L1049.4,161.0 L1046.6,160.6 L1043.0,163.5 L1041.5,162.9 L1040.5,161.7 L1040.6,155.6 L1033.7,152.1 L1025.0,155.2 L1022.4,153.5 L1022.0,148.9 L1018.0,144.5 L1009.4,147.6 L1004.3,144.4 L1004.0,139.8 L1007.5,136.6 L1009.4,132.2 L1013.6,127.5 L1019.0,124.2 L1019.4,122.7 L1009.1,115.7 L1004.9,113.4 L1001.9,114.0 L1000.1,116.4 L994.2,118.3 L993.7,119.8 L990.5,113.3 L986.6,108.9 L986.6,109.2 L982.2,107.5 L979.3,102.2 L978.3,97.5 Z',
        fill: '#1e40af', // Slightly lighter
        stats: { clients: 45, agents: 12, sites: 25 },
        x: 865, y: 294
    },
    {
        id: '47',
        name: 'Lot-et-Garonne',
        // Missing data in provided PostScript
        path: 'M722,442.5 L723,443.6 L725.2,444.4 L726.7,446.1 L727.9,446.7 L729.1,447.2 L729.8,448.6 L731.1,450.1 L731.9,452.5 L734.1,453.5 L735.6,455.2 L736.1,456.3 L736.7,458.3 L737.3,459.5 L738.4,460.5 L739,461.8 L738.9,463 L739,464.5 L739,466 L737.5,466.6 L736.8,468.5 L737.7,470.5 L740.2,471.5 L741.4,472.2 L742.4,473.9 L742.9,475.1 L742,477.3 L740.8,480.2 L739.7,481.3 L739.9,482.4 L739.8,483.4 L739.5,484.5 L739.7,486.1 L739.2,487.2 L739.6,488.3 L740.3,490.1 L740.2,491.1 L741.5,491.1 L742.6,489.6 L744.1,488 L746,488.3 L747.5,491.5 L749.3,491.7 L750.7,491.1 L752.2,491.1 L753.5,491.5 L755.6,492.4 L756.7,493 L759.3,493.7 L760.5,494.6 L761.6,495.2 L762.9,494.9 L764.3,493.9 L765.5,493.1 L766.9,492.8 L768.3,492.2 L769.9,492.7 L771.1,492.6 L774,490.8 L775.2,489.9 L775.9,488.2 L777.2,487.8 L778.3,487.4 L778.9,486.1 L780.1,485.1 L781.1,484.9 L782.2,484.6 L783.3,485.7 L784.6,485.7 L785.9,485.4 L786.9,485.7 L788.3,485 L789.1,483.7 L791.6,482.5 L792.6,482.4 L793.6,480.5 L795.3,480.4 L796.6,480.8 L798.4,480.9 L799.5,480.4 L800.8,481.5 L802.2,482.5 L802.4,483.7 L803.1,485.8 L805.1,486.4 L806.4,486.3 L808,486 L808.4,484.5 L809.4,483.9 L811.2,483.2 L812.7,483.6 L814,481.8 L815.2,477.7 L815,476.7 L815.2,474.7 L816,473.4 L817.2,473.1 L818.6,471.2 L819.6,471.4 L822.3,472.7 L824.5,473.3 L826.1,472.8 L828,473.4 L829.1,473.6 L830.4,474.6 L831.6,474 L831.5,472.9 L830.9,470.6 L832.5,469.3 L833.4,468.3 L835.6,468.6 L837.4,468.9 L839.7,469.3 L840.5,470.7 L840.7,471.8 L842,472.2 L842.4,473.6 L842.3,475.6 L842.9,478.3 L843.4,479.7 L843,480.7 L844.2,481 L845.8,481.2 L847.2,480 L849.7,480.9 L851.2,481.8 L852.4,481.5 L855.2,481.2 L856.9,480.8 L858.5,480.5 L860.7,480.9 L862.2,481.5 L864.7,480.9 L866.6,481.4 L869.5,480.6 L872.3,478.9 L874.4,479 L877,479.2 L877.4,480.7 L878.5,480.4 L878.4,478.9 L878.4,477.5 L878.3,475.9 L881.1,477 L883.6,477.7 L886.7,477.3 L886.1,475.6 L886.5,473.6 L887.3,472.1 L890.1,469.9 L892.1,470.5 L893.8,471.6 L896.3,472.8 L896.9,471.4 L897.5,472.9 L898.6,473.8 L899.9,474.4 L900.8,475.8 L901.3,477 L900.7,479.4 L900.5,481.2 L899.5,481.6 L899.9,482.7 L901,483.4 L902,484.1 L904.6,484 L905.9,484.5 L906.9,484.2 L908.5,484.7 L906.9,485.8 L905.1,486 L905.3,487.1 L905.5,488.5 L904.9,489.6 L905.7,491.3 L904,491.1 L902.6,491.8 L903.2,494.5 L902.9,495.5 L903.4,497.5 L902.2,498.5 L903.6,500 L902.2,499.9 L900.6,500.8 L899.3,501.9 L898.2,502.4 L896.6,503.7 L896.8,505 L898.4,505.2 L899.8,507 L899.3,508.4 L900.7,510.1 L902.4,509 L903.4,508.7 L904.1,509.7 L904.3,510.9 L903.8,512.8 L902.4,514.2 L901.9,515.6 L903.1,515.6 L904.6,515.8 L907.3,515.6 L908.4,515.9 L910,516.8 L912.1,516.7 L913.6,516.7 L915.3,515.7 L915.5,514.4 L915.4,513.3 L916.1,511.8 L915.4,510.8 L915.7,509.8 L916.8,508.8 L917.9,509.4 L919.3,508.8 L921,509.4 L922.6,508.7 L924.8,508 L926.4,506.3 L927.7,505.8 L929.1,504.8 L931.6,503.5 L932.1,501.9 L933.1,500.4 L934.4,499.9 L935.4,499.4 L937.5,498 L939.3,497.7 L940.5,497.3 L942.3,498 L944.4,498.2 L945.8,499.8 L947.3,500.3 L948.5,498.7 L949.1,497.1 L950.1,497.1 L951.2,496.1 L952.1,497.2 L953.9,498.3 L955,499.1 L957,501.6 L957.1,502.8 L959.5,505.2 L961,508.1 L962,508.4 L962.6,509.4 L963.6,509.8 L965,510.6 L966.5,510.8 L968.3,511.8 L969.3,512.1 L972.3,513.3 L973.3,513.3 L974.8,514.5 L976.2,516.4 L978.7,517.5 L979.9,517.6 L981.7,517.4 L982.6,518.6 L983.8,520.1 L984.3,521.7 L984.3,523.2 L983.6,524.3 L983.3,526.2 L982.8,527.3 L982.9,528.7 L982.2,530.5 L979.5,532 L977.9,532.2 L975.4,532.5 L974,533.2 L973,533.3 L972.5,534.7 L970.9,535.5 L969.4,536.3 L968.1,537.6 L968.6,538.8 L967.2,539.4 L966.1,540.4 L963.3,543.7 L962.4,544.8 L962.2,543.7 L961.5,542.3 L961.5,540.4 L960,539.5 L958.1,539.6 L956.4,538.7 L955.2,538.9 L953.5,539.7 L952.2,540.6 L952.1,541.9 L953.2,542.2 L954.5,543.7 L954.2,546 L955,547.3 L955.6,548.5 L956.9,549.1 L958,549 L958.4,550.4 L959.2,552 L960,553.5 L960.4,555.3 L962.1,556.9 L963.5,558.5 L963.7,560.1 L963.6,561.6 L962.3,562.6 L963.5,564.2 L963.7,565.4 L962.3,565.9 L962.8,566.9 L961.6,569.4 L962.4,571 L963.4,571.4 L965.8,572.3 L966.1,573.3 L965.4,574.5 L965.9,575.5 L966.2,576.7 L965.7,578.1 L966.3,579.4 L965.4,580.4 L965.8,582.1 L966,583.1 L965.4,584.1 L965.1,585.9 L966.2,587.1 L967.9,587.6 L968.9,587.7 L968,590.3 L968.8,591.4 L971.7,591.1 L973.3,590.9 L973.9,591.9 L974.6,593.1 L976.2,592 L976.6,594 L977.4,595.2 L977.8,596.6 L978.4,599.5 L978.3,600.6 L978.7,602.3 L978.2,604.3 L978.7,605.5 L977.6,606.8 L976.7,608.1 L975.5,609.5 L977.3,610.9 L978.3,610.4 L978.7,612.6 L979.3,613.8 L979.7,615.2 L979.4,616.6 L978.1,617 L978.4,619.3 L977.9,621.4 L975.7,622.4 L974.6,623.4 L973.1,623.2 L971.5,622.8 L967.5,622.6 L966.2,622.9 L964.5,623 L963.2,622.7 L961.6,622.3 L959.6,621.9 L958,620.7 L957,620.3 L955.9,621.4 L954.9,623 L953.3,623.9 L952,625.2 L950.4,626.2 L949.9,625 L949.7,623.8 L948.1,624.1 L946.3,624.1 L945.3,624.6 L943.5,624.1 L941.8,623.8 L941.3,624.8 L940.8,626.1 L938.5,627.6 L939.6,628.9 L939.8,630 L938.7,631.4 L937.9,628.8 L937.6,626.3 L937.6,624.8 L937.1,622.8 L937.1,621.4 L936.9,620.2 L935.6,618.7 L933.5,617.7 L932.2,616.1 L931.6,614.3 L929.5,613.6 L928.1,614.1 L926,614.7 L923.8,614.9 L922.8,615.9 L922.8,618 L921.6,619.6 L921.1,620.7 L920.2,622.4 L920.8,623.8 L922,624.5 L922.2,626.1 L922.3,627.4 L922.1,629.7 L923.2,630.7 L922.5,632.6 L921.6,634 L920.6,634.1 L920.2,635.2 L920.3,636.4 L919.1,637 L918.2,638.2 L917.4,639.3 L915.5,640.9 L916.2,642.6 L915.9,644 L914.8,645 L914.9,646 L914.1,647.1 L915.1,646.8 L916,647.8 L918.7,647.9 L919.8,648.8 L920.2,650 L921,651.8 L922.5,653 L923.4,652 L924.7,651.6 L926.2,652 L929.3,651 L931,651.8 L931.1,653.1 L931.9,654.7 L932.3,656.2 L933.1,657.7 L934.2,657.7 L935.9,658.2 L936.4,659.4 L938,659.7 L938.6,660.7 L939.6,661.8 L938.6,662.5 L941.2,662.4 L941,664 L940.2,665.3 L939.8,666.8 L938.8,667.5 L936.6,667.1 L934.9,666.8 L933.8,666.3 L933.9,667.3 L933.7,668.7 L935.8,671.1 L935.2,672.2 L935.1,673.2 L935.4,675 L933.4,675.1 L932.7,676.1 L931,678.9 L932.3,680.4 L933.4,681.4 L934.3,683.2 L932.9,684.9 L931.8,688 L931.4,689.5 L929.8,692.1 L929.2,693.8 L928.3,694.9 L927.4,696.8 L926.2,698 L927,699.1 L926.8,700.5 L925.7,701.4 L922.7,700.9 L921.5,700.9 L920.2,701.2 L918.4,700.7 L916.5,700 L913.4,699.9 L911.6,699.8 L911.2,700.9 L909.8,701.7 L909.2,703 L908.7,704.1 L908.8,706 L908.4,707.5 L911.4,708.8 L912.7,708.8 L912.7,710.1 L914.7,711.4 L916,710.7 L918.8,707.9 L920,709.5 L921.2,710.3 L921.1,711.6 L920.7,712.9 L919.7,713.9 L919.5,715.3 L920.4,716.8 L921.1,717.9 L920.5,719 L920.6,720.9 L921.9,721.9 L922.4,722.9 L922.4,724.9 L920.9,724.7 L919,723.8 L917.7,724.8 L918.7,727 L917.6,728.3 L916.2,728.6 L914.5,729.2 L913.4,730.1 L912,729.9 L911,729.3 L910,728.3 L907.3,727.7 L904.9,726.6 L903.8,726 L902.5,725.4 L900.3,724.2 L898.2,723 L897.2,722.2 L894,722.1 L892.5,721.7 L891.2,722.6 L889.5,721.4 L887,722 L887.5,723.5 L888.3,724.7 L889.2,727 L890,728.3 L889.5,730.5 L889.3,732.2 L888.5,733.6 L889.3,734.8 L890.5,736.1 L890.5,737.2 L889.3,736.5 L887.9,736.1 L886.2,736.7 L885.2,736.5 L883.7,736.1 L882.7,734.9 L881.4,735.8 L880,737.2 L878.7,738.1 L877.2,738.3 L875.2,739.9 L875,741.2 L875.3,742.3 L873.7,743.1 L873.5,744.3 L873.2,746 L873.3,747.3 L872.5,748.7 L872,749.7 L871.3,751 L870.1,753.2 L870,755.7 L870.6,757.2 L870.7,758.3 L870.3,759.7 L868.7,759.1 L866.7,759.4 L865.7,760.2 L864.2,760.9 L862.8,761.3 L859.9,760.9 L858.4,762.3 L857.4,763.4 L856.8,765 L856.2,766.8 L855,766.4 L853.1,766.5 L852,767.5 L851.1,769.4 L850.3,770.6 L850.3,772.2 L850.4,774 L849.6,775.1 L847.4,775.2 L846,775.9 L844.7,776.4 L843.1,774.4 L841.2,772.3 L842.3,770.6 L841.8,769.1 L841.8,768.1 L840.2,767.1 L838.3,767.4 L836.8,766 L836.6,764.8 L834.3,764.9 L833.9,762.6 L833.5,761 L833,759.9 L831.7,758.6 L830.5,757.5 L828.7,756.7 L827.7,756 L826.1,755.8 L825.4,754.3 L823.4,753.4 L824.1,752 L822.7,751.8 L821.6,751.4 L820.5,752.5 L818.9,752.5 L817.8,752.7 L816.8,752.7 L815.6,753 L816.4,754.2 L815.3,755 L814.6,756 L813.3,758.3 L812.5,760 L809.7,761 L808.7,762.5 L807.4,762 L805.6,761.8 L804.3,761.9 L803,763.3 L802,762.6 L800.9,761.4 L799.1,761.6 L797.1,761.4 L795.9,760.2 L794.1,758.7 L792.1,761.9 L792.1,763.8 L790.8,761.3 L788.6,761.2 L786.6,761.7 L785.1,761.1 L785.2,763 L783.5,762.9 L781.9,762.3 L780.1,762.3 L778.8,762.6 L776.5,762.3 L776,763.6 L774.4,765.6 L773.3,767 L772.2,768.7 L771.2,770.4 L771.2,771.5 L771.1,773.4 L769.6,774.1 L767.6,774 L764.9,775.5 L763.7,774.8 L762.6,773.9 L761.3,774.8 L760.7,777.1 L759.2,777.4 L757.2,777 L755.4,777.2 L755.5,778.3 L754.2,778.6 L753.5,779.7 L751.2,783.4 L750.2,784.4 L748.6,784 L746.8,783.6 L745.7,782.7 L745.1,781.1 L743.8,780.1 L742.4,779.6 L740.8,780.3 L741.1,781.6 L740,781.2 L738.2,781.5 L734.9,782.4 L732,784 L729.8,783.6 L728.4,782.7 L727.8,783.7 L727.6,784.9 L728.2,785.9 L729.4,787.9 L728.8,789.7 L727.4,789.2 L725.9,789.3 L724.1,790.6 L723,790.7 L721.5,790.1 L720,789.8 L718.2,789.1 L716.3,787.9 L713.9,787.8 L713.1,786.7 L712.8,785.7 L711.7,785.7 L710.5,785.4 L709,784.5 L707.7,784.4 L707.2,786.2 L705.2,785.1 L703.6,784.5 L702.6,784.1 L701.4,783.4 L699.4,782.6 L699.9,781.6 L700.8,779.9 L700.6,777.9 L698.9,777.8 L697.6,778.6 L696.4,778.4 L695,777.5 L694,776.9 L693.6,777.9 L692.6,778.4 L691.2,777.8 L690.6,779 L690.5,780.1 L690.5,781.4 L688.5,780 L687.4,781.2 L685.8,780.7 L684.4,783 L683.3,785.2 L682.7,787 L681.4,786.5 L680.4,787.6 L678.1,788.7 L677.7,790.3 L678,794.4 L677.8,795.9 L677,798.2 L675,799.6 L673.6,799.5 L672.6,799.2 L670.8,798.9 L668.6,798.7 L668.4,797.7 L669.5,792 L669.7,789.9 L668.6,788.4 L666.3,786.9 L665.2,786.8 L665.1,787.8 L664.5,788.9 L663.4,789.1 L662.4,789.4 L662,790.6 L662,791.8 L660.5,792.7 L658.5,793.7 L657.4,794.3 L656.4,794.3 L655,793.8 L653.8,793.6 L651.9,793.8 L650.8,794.3 L648.9,795.8 L647.7,795.4 L647.5,794.1 L646.7,792.2 L645.8,790.9 L644.7,789.1 L643.1,786.9 L643.1,785.8 L642.5,784 L642.9,782.8 L642.7,781.8 L643.1,779.8 L642.7,776.9 L642.8,775.8 L644,775.6 L646.3,775.8 L647.6,773.7 L648.5,771.5 L649.6,769 L648.8,767.6 L649.6,766.3 L649.9,764.9 L651.4,763.7 L651.5,760.9 L650,758.5 L653.8,757.6 L653.9,756.4 L654.7,752.6 L655.2,751.6 L656.5,752.3 L657.1,750.1 L656,749.2 L656,747.8 L657.1,747 L658.8,745.4 L660,744.7 L660.4,743.5 L661.4,742.9 L662.1,741.5 L663.1,741 L663.6,739.6 L664.7,739.5 L665.9,738.8 L667.3,738.1 L667.5,736.7 L667.1,735 L666.2,733.1 L667.3,731.4 L660,730.4 L654.8,729.9 L648,729.4 L646.9,729.5 L642.2,728.9 L638.8,728.5 L633.7,728.2 L631.7,725.3 L630.5,724.7 L621.5,719.8 L620,719.5 L618.5,719.6 L617.2,719.6 L609.7,719.2 L608,719.2 L601.9,719.1 L599,718.1 L597.7,717.9 L596.7,718 L595.5,717.8 L594.1,717.3 L592.9,716.6 L591.2,717.4 L589,717.2 L587.7,717.3 L586.7,717.1 L585.5,717.4 L583.9,718.4 L578.7,718.4 L578.6,716.2 L578.5,710.4 L578,701.7 L578.2,699.4 L578.5,695 L577.4,691.8 L575.3,686.6 L574.8,684.9 L579.4,681.8 L580.4,680.1 L580.7,678.4 L582,678.8 L581.7,680.2 L585.8,682.8 L588.6,681.6 L589.6,679.6 L592.4,680.4 L592.4,679.1 L593.7,677.5 L595.2,675.9 L596.8,674.7 L597.1,673.1 L598.2,673.9 L599.4,674.9 L600.5,674.7 L602.3,671.6 L602.1,670.3 L603.3,668.6 L604.1,667.1 L606.7,665.1 L608.2,665.1 L611,664.4 L610.6,662.4 L610,660.7 L609.6,657.8 L607.5,654.5 L610.4,653.1 L602.1,641.9 L599.7,641.5 L596,636.9 L593.2,634.6 L595.6,627.3 L598.7,627.7 L601.7,624.8 L603.8,624.8 L604.8,624.8 L606.1,624.6 L607.6,624.1 L609.3,624 L610.3,624 L612.4,624.4 L612.7,623.4 L614,622.7 L616.2,621.3 L617.5,619.4 L618.9,619.6 L621.1,618.6 L622.5,618.9 L623,620.6 L624.1,621.2 L626.4,621.5 L627.6,620.9 L628.3,619.1 L629.8,617.4 L627,615.6 L625.4,615.5 L624.4,614.6 L626.2,613.9 L627.3,613 L628.5,612 L628.2,611 L626.2,608.5 L624.9,608 L623.5,607.4 L624,606.1 L622.4,605.2 L620.9,603.5 L620,601 L619.3,599.9 L620.3,598.3 L617.4,597.9 L618,596.4 L619,595.7 L620.1,595.5 L620,593.8 L620,592.7 L619.1,591.1 L620.1,590.3 L620.8,588.6 L620.5,587.4 L622.2,587.1 L624.6,585.1 L624.5,582.9 L623.7,580.7 L622.5,579.8 L621.1,578.9 L618.8,579.7 L617.6,579 L617.9,577.4 L617,575.5 L617.7,574.3 L617.8,572.3 L617.5,570.8 L617.4,569.6 L617.1,567.9 L616.6,566.8 L616.2,565.5 L616.1,564.1 L617,561.6 L617,559.2 L617,558.2 L618.8,556.5 L618.6,555.5 L619.7,554.9 L620,553.3 L621.3,553.3 L622.5,551.8 L623.5,551.2 L624.9,551.4 L626,550.1 L626.9,549 L628.1,547.7 L626.6,544.6 L625.1,543.7 L624.2,542.7 L623.6,541.7 L623,540.2 L622,539.7 L621.7,537.7 L623.3,538.3 L625,539.5 L627.2,541.6 L628.2,542.2 L629.3,541.6 L630.2,540.2 L632.1,539.2 L633.4,537.9 L634.7,536.7 L637.1,538 L639.4,537.5 L640.7,537.6 L642.2,538.1 L643.7,538.3 L645.1,539.4 L646.1,538.8 L647.1,537.7 L647.2,533.9 L647.7,532.4 L649.5,532.7 L650,530.5 L649.5,529.5 L651,526.7 L650.5,525.2 L649.7,523.1 L651.1,522.2 L652.5,521.9 L654.2,521.8 L655.4,521.5 L656.7,521.3 L658.4,520.5 L659.5,520.4 L660.6,519.3 L662.1,518 L663.2,517.6 L664.7,515.8 L666.3,513.9 L667.1,512.7 L669.8,512.4 L671.5,512 L672.7,512 L673.9,510 L672.9,508.1 L672.5,507 L671.6,505.9 L670.7,504.5 L668.9,503.7 L668.9,502.7 L667.9,501.4 L669,500.9 L668.2,499.6 L668.5,498.3 L669.5,497.3 L670.2,498.3 L670.3,499.3 L672.1,500.5 L674.2,501.5 L675.4,501 L676.8,501.2 L677.6,500.2 L678.5,499 L678.4,498 L678.1,496.6 L678.7,494.7 L680.2,492.8 L681.7,491.1 L682.7,490.1 L683.3,489.1 L683,487.2 L682,486.8 L681.6,485.5 L680.1,485.4 L679,485.1 L676.5,484 L675.5,485.1 L674.1,485.3 L673.1,485.1 L672,485 L671.6,486 L670.5,486.3 L669.3,486.2 L668,485.9 L666.6,485 L665.7,483 L665.9,481.8 L666.6,480.6 L667,478.6 L665.9,478.3 L663.5,478.3 L661.8,478.4 L660.5,479.2 L659.3,477.6 L657.8,477.2 L656.9,475.9 L657.4,474.6 L657.6,472.6 L656.4,472.4 L656.5,471.3 L655.8,470.3 L657,470 L658.1,468.1 L658.2,465.9 L659.4,465.9 L661.2,465.7 L663.1,465.7 L664.8,466.5 L665.4,467.6 L666.9,468.6 L667.4,467.4 L667.2,466.4 L668.3,465.3 L668.9,464.3 L668,463.1 L667.3,460.9 L668.9,461.1 L668.7,459.8 L669,458.8 L668.9,457.3 L668.5,455.8 L669.1,454.2 L671.5,455.5 L672.7,456.4 L674.1,456.7 L675.2,456.5 L676.5,455.5 L677.3,454.5 L679,454.3 L680.4,455.3 L681.2,454 L681.1,452.5 L682.2,451.1 L682.7,450.1 L683.9,448.7 L684.9,448.8 L686.5,448.6 L686,449.8 L687.5,451.5 L687.7,453.7 L688.1,454.8 L688.7,457 L689.1,458.6 L689.7,460.2 L691.9,459.7 L693.1,460 L694.7,460 L695.7,459.6 L695.4,458.3 L694.5,456.5 L693.8,455.4 L693.8,453.8 L692.6,452.4 L693.3,451.3 L694.4,450 L693.8,448 L694.8,447 L695,445.6 L695.9,444.2 L697.5,443.6 L698.2,441.6 L700.1,441.8 L701.1,441.9 L702.8,442.1 L703.1,444.4 L704.3,446.9 L705.3,447.5 L706.6,448 L708,448 L710.5,447.4 L712,447.3 L713.4,446.6 L714.4,446.3 L715.8,446.2 L717.4,445.3 L719,445.1 L720.2,444.2 L721.2,444.7 L722.1,443.5 L722,442.5 Z',
        fill: '#1d4ed8',
        stats: { clients: 30, agents: 10, sites: 15 },
        x: 789, y: 609
    },
    {
        id: '40',
        name: 'Landes',
        // Extracted ID 3
        path: 'M651.1,776.0 L656.8,768.8 L655.8,765.8 L663.7,757.9 L668.0,755.7 L666.5,751.6 L667.9,749.3 L634.9,745.1 L632.1,741.5 L622.8,735.8 L622.7,735.8 L604.4,734.7 L595.4,732.0 L589.2,732.3 L586.4,733.7 L581.8,733.1 L582.5,710.3 L579.3,699.4 L571.1,691.7 L568.3,684.2 L563.9,679.4 L562.5,678.8 L558.5,681.4 L552.2,680.9 L551.3,685.5 L551.9,707.6 L535.4,712.4 L523.4,707.7 L503.2,705.1 L497.8,703.7 L496.1,690.9 L501.3,668.9 L495.2,668.3 L486.5,661.4 L486.2,651.8 L470.8,650.0 L458.6,643.1 L455.7,631.4 L445.5,626.3 L442.3,622.7 L419.6,613.5 L424.8,610.1 L424.8,594.4 L421.2,591.5 L410.9,587.6 L409.3,587.6 L407.2,590.0 L408.2,591.2 L406.1,593.3 L401.9,593.3 L392.8,590.8 L377.3,593.4 L375.9,594.1 L375.0,598.7 L370.4,598.6 L365.0,601.7 L353.9,602.0 L333.4,593.1 L330.2,589.7 L312.9,595.2 L294.0,597.2 L301.3,591.3 L306.8,580.2 L311.0,569.8 L309.6,560.3 L308.3,557.4 L295.7,558.2 L278.3,546.6 L270.6,559.7 L239.9,568.5 L222.0,573.0 L210.2,641.8 L192.3,730.0 L162.3,847.7 L158.7,856.7 L147.2,899.3 L137.6,944.3 L121.1,975.5 L109.7,993.5 L117.3,995.2 L124.8,990.0 L130.0,993.1 L128.8,1000.6 L131.8,1000.1 L140.8,1003.2 L144.2,1010.3 L145.3,1010.3 L160.0,1012.1 L171.7,1009.1 L171.9,1009.1 L175.9,1008.5 L185.9,1012.0 L211.1,998.6 L218.7,992.0 L225.8,992.4 L230.5,996.0 L232.1,1000.4 L238.4,1004.9 L239.3,1007.7 L237.0,1009.6 L227.9,1009.7 L225.6,1011.0 L226.1,1014.7 L226.1,1016.6 L227.3,1017.5 L231.4,1015.4 L234.0,1019.0 L235.5,1018.6 L236.8,1014.2 L238.3,1014.2 L243.9,1012.8 L247.1,1008.0 L252.9,1009.4 L256.0,1004.5 L258.2,1006.1 L259.7,1011.3 L267.3,1010.3 L271.7,1011.5 L274.4,1015.1 L276.4,1013.3 L284.9,1014.6 L284.4,1012.3 L286.3,1008.2 L286.3,1002.2 L282.7,999.5 L287.0,998.3 L299.6,1002.5 L301.7,1000.4 L304.4,1000.5 L306.8,1002.4 L308.3,1001.9 L309.9,997.7 L312.4,995.9 L318.5,995.3 L328.2,998.5 L330.8,999.7 L335.1,999.2 L335.6,994.4 L342.8,991.4 L348.5,994.0 L351.7,990.6 L355.8,989.9 L355.8,985.6 L359.9,984.1 L371.3,995.3 L372.9,1000.2 L375.2,1002.0 L379.5,1002.2 L380.1,994.7 L382.5,992.9 L386.3,995.5 L395.6,990.5 L402.0,988.2 L402.0,988.2 L396.5,994.7 L401.4,997.9 L404.4,997.6 L405.2,999.3 L410.4,1002.2 L410.5,1005.3 L415.2,1005.2 L426.5,996.8 L428.1,999.3 L429.5,1003.9 L430.9,1003.8 L440.3,997.6 L444.5,995.5 L446.4,992.9 L446.3,992.6 L460.7,984.0 L461.8,984.9 L466.1,981.2 L468.7,982.6 L471.7,987.2 L465.6,993.7 L461.8,995.4 L465.1,1002.2 L469.1,1001.1 L479.9,994.5 L481.5,996.9 L485.5,994.8 L497.0,998.2 L498.5,1000.8 L502.4,1003.2 L512.7,999.9 L514.3,997.2 L514.5,994.6 L516.8,996.2 L519.2,993.3 L520.6,989.0 L529.5,987.5 L531.1,990.2 L532.6,990.2 L534.0,989.2 L532.1,983.8 L530.6,983.7 L533.1,975.1 L524.1,974.7 L522.0,971.1 L522.1,962.3 L527.0,965.3 L528.2,964.5 L529.0,960.4 L529.9,958.1 L534.2,957.4 L536.6,950.1 L532.1,949.1 L531.1,947.8 L532.0,944.7 L536.6,940.4 L534.8,932.7 L543.3,928.7 L552.9,920.9 L552.2,916.4 L545.0,914.5 L546.8,912.1 L548.3,911.9 L548.9,910.4 L546.5,904.5 L546.9,899.9 L544.6,897.8 L545.9,893.5 L543.4,888.4 L547.1,886.3 L548.1,887.8 L554.0,888.1 L553.9,879.0 L556.1,877.0 L555.0,874.1 L550.3,865.9 L551.9,864.7 L554.9,861.2 L557.0,862.6 L558.1,862.0 L555.6,855.2 L553.3,853.4 L550.6,853.3 L548.6,851.4 L546.1,849.9 L543.2,850.4 L540.9,847.1 L543.2,845.6 L545.0,841.4 L546.5,841.1 L548.6,843.1 L551.0,841.3 L554.0,840.1 L562.1,830.9 L565.6,833.9 L568.5,833.0 L571.5,829.7 L575.9,831.2 L579.2,828.0 L586.4,835.7 L588.8,834.2 L588.0,828.8 L590.1,826.4 L594.1,828.6 L595.6,828.2 L600.5,822.1 L606.2,819.9 L609.2,810.9 L622.4,824.2 L622.2,828.9 L613.4,835.9 L625.1,843.9 L630.5,849.8 L633.2,848.3 L638.9,850.9 L642.4,847.9 L644.5,843.6 L643.2,834.2 L638.8,824.1 L642.9,819.6 L643.1,816.5 L646.0,812.6 L642.0,804.2 L642.0,796.5 L641.5,793.4 L644.6,793.1 L646.8,791.0 L651.1,776.0 Z',
        fill: '#2563eb',
        stats: { clients: 60, agents: 20, sites: 35 },
        x: 389, y: 783
    },
    {
        id: '64',
        name: 'Pyrénées-Atlantiques',
        // Missing data in provided PostScript
        path: 'M540.5,975 L542,976 L543.1,975.7 L543.7,973.3 L545,972.7 L548.1,972.3 L550.2,971.5 L551.3,971.2 L552.3,973.1 L552.9,974.9 L555.3,974.3 L558,973.7 L559.3,972.6 L560.9,971.4 L562,969.8 L563.3,970.8 L564.9,972.3 L565.4,973.9 L566.2,975.2 L568.1,977 L569.6,975.2 L570.9,974.7 L572.3,974.6 L574.6,975.8 L575.6,977.3 L577,976.5 L578.7,976.7 L579.7,975.7 L580.7,975.1 L582.9,975 L584.9,975.7 L586.6,976.6 L587.8,976.1 L589.5,976.1 L589.8,978.2 L589.8,979.4 L590.4,980.4 L591.4,981.6 L591.4,982.6 L590.6,984.6 L591.8,985.9 L592.2,987.5 L591.8,988.6 L590.9,990 L590.1,991.6 L590.4,993.5 L592.3,994.4 L593.5,994 L594.6,993.2 L595,992.2 L599.1,992.1 L600.4,992.5 L600.6,994 L601.7,994.4 L602.4,996.9 L603.2,998.5 L604.5,1000 L605.5,1000 L605.9,1001.1 L607.1,1002 L607.4,1003 L607.5,1004.2 L607.3,1006.3 L608.2,1007.4 L607.2,1010.4 L606.8,1012.8 L606.3,1014.3 L605.6,1015.8 L605.4,1017.1 L606.7,1017.7 L608.6,1018.1 L610.3,1018.6 L610.3,1020.2 L610.8,1022.5 L610.6,1023.8 L612.3,1025.5 L616.1,1026 L615.7,1027 L615.6,1028.5 L613.3,1028.8 L611.8,1028.5 L610.1,1028.9 L609.1,1029.3 L607.8,1029.5 L606.8,1029 L604.6,1029.1 L602.4,1029.4 L601.5,1030.5 L600,1029.9 L599.8,1031.2 L600.4,1032.6 L601.4,1034.2 L600.5,1037 L599.6,1038.8 L599.8,1040.4 L599.2,1041.4 L598.3,1042.7 L598.7,1043.7 L599.9,1044.6 L602.5,1046 L603,1047.1 L604.1,1048.2 L605,1049.8 L601.8,1050.4 L600.3,1052.7 L599.5,1053.9 L601.7,1053.7 L602.9,1053.3 L604.3,1053.2 L606.4,1054.2 L607.6,1054 L607.7,1052.4 L608.8,1051.7 L608.8,1050.7 L609,1049.7 L610,1048.7 L610.9,1045.9 L610.4,1044.9 L610.7,1043.9 L612.4,1043.9 L613.7,1045.1 L614.6,1043.6 L614.7,1042.1 L616.3,1040.1 L616.5,1038.8 L617.7,1039.1 L618.7,1038.8 L619.9,1038.8 L621.2,1038.2 L621.8,1039.7 L621.8,1040.7 L621.1,1042.9 L620.4,1044.3 L624.6,1047.9 L624.7,1049.7 L624.3,1050.9 L624.3,1052.6 L622.8,1054.7 L621.7,1056.1 L621.6,1057.9 L621.4,1059 L621.9,1060.3 L620.6,1060.8 L622.5,1060.5 L623.7,1061.4 L622.6,1062.7 L621.4,1064.4 L622.4,1065.2 L621.5,1067.4 L620.4,1069 L620.4,1070.2 L622.6,1072.7 L623.6,1071.9 L624.8,1072.9 L624,1075.1 L624.9,1076.1 L626.1,1076.7 L626.8,1077.9 L628,1080.1 L629.2,1081.4 L630.8,1081.9 L632,1083 L631.5,1084.2 L630.2,1086.4 L629.1,1087.3 L627.9,1088.8 L626.3,1091.4 L625.5,1092.4 L624.4,1092.2 L622.5,1089.9 L621,1089.3 L617.4,1089.6 L616,1089.6 L614.8,1090.9 L613.5,1090.5 L612.9,1092.4 L612.4,1094.7 L612.2,1096.7 L611.1,1098.8 L609.9,1099.9 L609.4,1101.2 L608.4,1101.9 L607.3,1101.8 L607,1103 L606.8,1104.7 L606.8,1105.7 L607.2,1107.4 L607.3,1109.2 L607.1,1110.5 L608.5,1111.4 L610.4,1112.2 L611.5,1112.4 L614,1112.8 L613,1114.8 L614.3,1115.4 L616.1,1115.4 L616.3,1117.2 L615.8,1118.2 L613.9,1120.5 L613.4,1121.5 L613.6,1122.9 L614.1,1124 L613.3,1125.5 L611.5,1127.6 L610.2,1128.6 L609,1130.8 L608.2,1132.1 L607.2,1133.2 L606.7,1134.3 L606.7,1135.4 L607,1136.7 L606.5,1137.7 L605.4,1141.3 L603.8,1140.6 L601.4,1139.4 L598.2,1138.1 L597.2,1139 L598,1140.1 L597.9,1141.8 L597.8,1144.5 L598.1,1146 L598.4,1147.1 L598.6,1148.4 L598.6,1149.7 L598.7,1151.4 L598,1152.6 L598.3,1153.7 L599.1,1156.9 L599.3,1158.4 L599.3,1159.4 L596.9,1159.6 L595,1159.6 L593,1159.6 L591.4,1159.3 L590,1159.4 L589.7,1160.6 L589.3,1163.5 L587.7,1164.1 L586.5,1164.2 L586.3,1161.9 L585.4,1160.4 L585.1,1159.4 L584.7,1158.4 L582.5,1158 L582.2,1159.6 L581,1161.4 L580,1164.3 L579.4,1167.1 L579.6,1168.2 L578.6,1168.4 L577.7,1170.1 L575.5,1172.1 L575.3,1173.4 L575.6,1174.5 L574.5,1174.5 L574.1,1176.2 L574.7,1178.1 L573,1181.5 L571.6,1182.1 L570.4,1182.6 L569.7,1183.8 L568.2,1184.2 L566.9,1184.1 L564.8,1185.9 L565.2,1187.9 L563.6,1188.7 L563.3,1189.7 L560.4,1188.8 L557.4,1187.3 L557.7,1188.6 L557.7,1190.3 L557.7,1191.8 L556.5,1192.3 L555.5,1193.5 L555.6,1195.1 L556,1196.1 L559.3,1198 L558.9,1199.8 L559.4,1201.4 L557.8,1204 L557.3,1205.2 L556.2,1205.9 L555.2,1208.3 L555.1,1210.4 L556.1,1212.5 L557.4,1213.8 L559.7,1213.9 L561.1,1215.8 L558.3,1216 L556.1,1218 L554.8,1220.2 L552.9,1220.7 L551.7,1220.7 L551.1,1221.9 L550.1,1223.1 L547.8,1223.8 L546.8,1224.3 L544.7,1222.6 L543.4,1222.1 L541.6,1221.6 L537.2,1221.7 L535.3,1222.3 L534.5,1223.3 L534.3,1224.7 L535.6,1225.9 L535.9,1227 L535.9,1228.6 L535.5,1230.4 L535,1232.8 L533.8,1234.4 L532.5,1235.7 L531.1,1235.9 L529.3,1236.9 L527.8,1236.7 L525.5,1236.9 L525.1,1238.6 L524.8,1241 L523.5,1242.8 L524.2,1244.3 L524.1,1246.2 L524.3,1247.2 L524.7,1248.9 L524.2,1250.2 L524.8,1251.2 L525.4,1253.4 L525.5,1254.4 L525.2,1255.6 L524.6,1256.6 L525,1257.8 L526,1259.1 L527.3,1261.7 L527.3,1262.9 L527.7,1265.2 L528.3,1267 L527.4,1269.6 L526.4,1271 L524.6,1271.6 L522.4,1271 L520.1,1272.4 L518.6,1272.8 L518.2,1274 L517.6,1275.5 L516.2,1276.8 L514.3,1276.6 L512.1,1277.3 L512.5,1278.9 L513.2,1281.6 L512.8,1282.8 L513.7,1284.1 L514.3,1285.3 L515.8,1286.3 L515.8,1287.5 L515.9,1289 L515.5,1290.7 L516.2,1292.2 L516.8,1293.8 L518.2,1296.3 L518.5,1297.4 L518.9,1299.2 L517.9,1300.4 L517.5,1302 L517.9,1305.1 L517,1306.8 L516.3,1308.8 L515.5,1310.1 L514,1312.2 L514,1313.3 L511.3,1314.4 L510,1312.8 L508.7,1313.2 L507.2,1313.6 L505.4,1312.9 L504.9,1314.3 L503.5,1315.4 L502.4,1316.7 L501.4,1318.7 L501,1320 L499.9,1320.5 L499.8,1321.9 L498.4,1323.7 L497.2,1324.4 L496,1324.7 L494.8,1325.5 L493.4,1326.7 L493.2,1327.7 L493.2,1329.5 L491.7,1329.6 L489.4,1330.5 L488.7,1329.5 L487.4,1329 L486.4,1328.2 L485.2,1327.5 L484.6,1326.5 L481.3,1327.4 L479.1,1329 L476.4,1330.6 L475.2,1331 L474,1332 L473,1331.8 L471.6,1330.3 L470.3,1328.4 L468.2,1328.3 L467.1,1328.1 L465.8,1327.4 L464.4,1326.5 L463.2,1326.3 L461.4,1325.7 L461,1324.3 L460.1,1323.2 L458.9,1322.5 L457.8,1322.3 L456.7,1322.4 L454.6,1320.6 L454.2,1318 L452.2,1317.6 L451.1,1318.4 L449.6,1320 L449.4,1321.4 L448.3,1322 L446.6,1323.5 L445.9,1324.5 L445.4,1326.1 L445.7,1327.5 L446.1,1328.8 L446.4,1330.4 L445.6,1331.4 L444.1,1333.8 L442.8,1333.4 L440.4,1332.9 L439.3,1333.1 L436.9,1340.2 L435.7,1339.3 L434.5,1339.4 L433.1,1338.8 L431.6,1338.8 L430.3,1337.7 L430.3,1334.3 L431.3,1333.1 L432.3,1330.9 L432.3,1329.5 L431.9,1328.3 L430.9,1326.9 L428.2,1326.3 L425.8,1328 L424.8,1327.8 L423.6,1328.8 L421.6,1327.7 L420.2,1327.1 L420.5,1325.8 L420.6,1324.1 L420.9,1322.5 L419.8,1320.8 L419.6,1319.7 L419.5,1318.7 L419,1317.3 L420.1,1316.7 L419.7,1315.7 L418.1,1314.8 L415.4,1313.9 L413.9,1312.8 L412.5,1311.4 L411.3,1309.6 L410.3,1308.7 L409.4,1306.8 L408.3,1305.9 L406.7,1305.7 L405.5,1305.3 L404,1305 L402,1303.7 L399.8,1301.1 L399.6,1300.1 L399.7,1299 L399.4,1298 L398.4,1296.8 L398.2,1295.8 L397.1,1295.3 L395.9,1294 L394.8,1292.6 L393.6,1292.4 L392.6,1292.3 L391.3,1292.5 L389.4,1293.5 L387.2,1294.4 L386.8,1293.1 L385.1,1291.8 L383.6,1291.9 L381.8,1290.8 L380.8,1290.9 L378.9,1289.4 L378.3,1288.4 L377.5,1286.5 L376.2,1286.5 L376.6,1284.8 L375.9,1283.7 L375.6,1282.3 L375.6,1280.5 L375.1,1279.3 L375.7,1278.2 L376.8,1277 L378.6,1276.3 L378.4,1275.1 L378,1273.7 L376.7,1272.9 L375.9,1271.9 L375.9,1270.6 L375.5,1269.5 L376,1268.1 L375.3,1266.7 L376.6,1264.2 L373.7,1263.2 L372.2,1261.3 L371.9,1259 L370.9,1257.6 L370.6,1256.5 L369.5,1254.5 L367.9,1253.8 L366.8,1254.3 L365.8,1254.1 L364,1253.7 L363,1254.8 L360,1255.6 L358.7,1255.6 L356.6,1255.9 L355.2,1257.1 L353.2,1258.1 L352.2,1259 L351.3,1260.1 L349.9,1261.5 L348.3,1261.7 L345.8,1261.7 L344,1261 L342.6,1261 L340.7,1260.2 L338.1,1261.1 L335.9,1261.3 L332.8,1261.8 L331.4,1261.8 L328.5,1260.3 L327,1260.1 L325.1,1259.5 L323,1259.6 L321.1,1259.8 L320.5,1257.8 L318.9,1256.3 L317.1,1255.7 L314.9,1255.9 L312.9,1258.4 L312.5,1259.8 L311.1,1260.4 L309.9,1260.4 L308,1261 L306.2,1260.5 L304.9,1260.7 L303.7,1259.7 L302.3,1258.8 L300.6,1257.9 L299.1,1257.3 L297.1,1257.4 L296,1256.8 L294.4,1255.9 L294,1254.8 L293,1253.6 L291.7,1252.6 L290.5,1252.1 L289.4,1251.8 L287.9,1251.2 L286.9,1250.5 L285.9,1249.5 L285.3,1247.4 L284.3,1246.1 L283.9,1244.5 L282.5,1243.2 L281.2,1242.7 L278.6,1242.9 L277.4,1243.2 L276.1,1242.8 L274.8,1241.9 L273.5,1241.7 L272.2,1241.5 L269.8,1241.4 L267.4,1241 L266.2,1241.4 L265,1241.1 L262.3,1240.6 L261.1,1240.2 L259.8,1239.5 L258.1,1238.8 L257.7,1237.1 L257.4,1236 L258,1234.6 L256.1,1234.6 L253.3,1233.6 L251.5,1232.6 L250,1231.4 L248.3,1229.7 L247.5,1228.7 L247,1229.7 L245.6,1231 L244.8,1232.4 L243.6,1232.7 L241.2,1234.8 L239.1,1235.1 L238.7,1236.1 L238.2,1234.9 L237.5,1233.6 L237.6,1231.7 L237.4,1230.2 L237.5,1228.9 L235.4,1227.2 L233.9,1226.4 L232.1,1225.3 L230.9,1223.8 L228.5,1223 L227.4,1223.9 L225.3,1224.8 L218.4,1219.7 L217.3,1218.9 L216,1218 L215,1217.1 L210.2,1214.9 L208.7,1214.5 L205.7,1218 L203,1220.4 L201,1220.5 L199.8,1220 L198.4,1219.8 L197.3,1219.4 L197.1,1218.4 L195.9,1216.9 L195.2,1214.8 L193.7,1214.3 L191.9,1212.9 L190.1,1211.7 L189.3,1210.7 L188,1210.8 L186.8,1210.5 L186.3,1209.5 L185.1,1209 L183.4,1209 L182.1,1208.5 L182.4,1206.7 L183.3,1204.9 L183.3,1203.3 L184.1,1201.2 L184.5,1200.1 L184.9,1199.1 L185.5,1197.7 L186.2,1196.4 L187.7,1194.7 L188.6,1193.7 L188.9,1192.5 L190.2,1191.5 L191.1,1190.4 L192.2,1189.4 L193.8,1188.2 L194.3,1187.1 L195.3,1185.9 L193.9,1185.8 L191.8,1186 L190.3,1186.3 L188.8,1187.2 L187.4,1187 L184.8,1187.5 L182.9,1187.5 L181.7,1188.2 L180.3,1188.4 L178.3,1188.5 L175.7,1190.4 L174.4,1190.8 L173.9,1192.8 L172.3,1193.9 L171.9,1195.2 L170.1,1197 L169.8,1198.6 L170.2,1200.1 L170.6,1201.3 L171.7,1203 L171.2,1204.1 L171.2,1205.2 L170.4,1206.6 L170.6,1209.2 L170.6,1211.1 L170,1213.9 L170.8,1214.9 L169.9,1217.3 L169,1220.2 L168.9,1221.8 L167.9,1225.1 L167.2,1226.8 L162.5,1225.4 L155.5,1223.5 L137.8,1218.6 L135.7,1215.1 L134.1,1212.8 L133.1,1211.2 L128.5,1204.5 L127.6,1202.9 L127.4,1201.2 L127.6,1199.4 L127.8,1198.1 L129.4,1196.3 L130.9,1195 L132,1194.9 L133.6,1194 L134.5,1192.4 L137.1,1191.1 L137.2,1189.1 L138.8,1188.8 L140.3,1187.5 L142.5,1186.7 L142.6,1184.8 L143.5,1183 L144.5,1183 L146.1,1182 L147,1180.9 L146.9,1179.4 L146.6,1178.2 L147.6,1176.9 L148,1175.6 L146.9,1173.4 L146.2,1172.3 L147.2,1171.5 L148.1,1169.9 L149.2,1169.2 L150.9,1169.1 L150.3,1167 L150.2,1165.5 L150.7,1164.2 L150.6,1162.3 L150.9,1160.3 L151,1159.1 L152.1,1157.4 L154.8,1155.2 L157.2,1154.7 L156.7,1152.9 L156.2,1151.8 L156.6,1150.2 L157.3,1149.1 L157.3,1147.4 L156.6,1146.1 L156.7,1144.9 L158.2,1142.6 L157,1140.5 L156.9,1139.5 L157.8,1137.5 L158.8,1136.6 L159.1,1135.5 L158.9,1133.2 L157.8,1129 L157.5,1125.1 L156,1123.8 L155.5,1122.6 L153.5,1120.7 L152.2,1119.4 L150.7,1118 L148.4,1116.7 L147.2,1115.9 L146.1,1116.3 L144.7,1117.8 L142.4,1118.8 L138.6,1119 L136.5,1118 L134.7,1117.5 L133.7,1116.9 L132,1116.8 L130.9,1116.8 L129.5,1116.4 L128.2,1115.7 L127.1,1114.9 L125.4,1114.1 L124.1,1112.4 L122.8,1111.8 L120.8,1112.7 L119.6,1111.7 L119.1,1110.7 L118.5,1109.7 L117.1,1108.5 L116.7,1107.5 L115,1106.9 L112.9,1106.6 L111.2,1107 L109.7,1107 L107.3,1106.8 L106.2,1106.3 L104.7,1107.8 L103.4,1107.4 L102.4,1107.6 L100.6,1107.6 L97.9,1108.6 L96.3,1109.3 L96.6,1110.6 L98,1111.2 L98.8,1113 L98.5,1114.3 L97.7,1116.2 L97.2,1117.3 L96.4,1118.8 L95,1123.4 L93.8,1125.2 L92.3,1126.5 L90.9,1125 L89.3,1125.4 L87.8,1124.9 L85.2,1124.4 L84.1,1124.6 L82.6,1125.4 L81.5,1125.6 L80.9,1124.4 L79.7,1123.9 L78.5,1122.7 L76.9,1120.2 L76.5,1117 L75.4,1114.2 L74.8,1112.1 L74.3,1110.9 L74.5,1108.9 L75,1107.9 L75.2,1106.5 L76.9,1103.6 L76.9,1102.4 L76.4,1101.1 L74.1,1100.6 L72.6,1099.8 L69.8,1100.8 L66.8,1099.3 L66,1098.1 L64.7,1097.7 L62.8,1097.7 L61.4,1097.1 L59.5,1098.5 L58.3,1098.8 L56.6,1099.1 L54.9,1099.7 L53.9,1098.9 L52.6,1098.3 L50.9,1099.5 L49.8,1099.7 L47.9,1101.4 L47.6,1102.5 L46.3,1103.7 L44.3,1103.5 L43,1103.9 L40.9,1105.8 L40.2,1103.8 L39.7,1102.8 L39.5,1101.1 L38.9,1099.2 L37.6,1098.8 L38.2,1097.7 L37,1096.3 L37.4,1095.2 L38.1,1093.9 L38,1092.4 L38.2,1090.1 L36.7,1089.5 L35,1089.8 L33.3,1088.7 L33.6,1087.5 L33.2,1085.4 L31.5,1084 L29.7,1084 L28.7,1084.6 L27.7,1084.8 L25.5,1084 L25,1082.3 L23.8,1082.1 L22.7,1081.7 L21.6,1080.6 L20.9,1079.2 L21.1,1078.2 L23,1075.8 L21.9,1075.2 L20.3,1073.3 L19.8,1071.9 L19.9,1070.9 L21,1068.4 L21,1070.4 L22.6,1070.7 L24.5,1070.9 L25.8,1070.9 L30,1069.6 L31.4,1068.4 L31.3,1067.2 L31.8,1065.8 L32.9,1065.5 L33.3,1064.5 L34.4,1064.2 L34.5,1066.2 L36,1066 L37.5,1067.3 L38.5,1066.7 L40.5,1066.3 L43,1065 L44.4,1064.6 L45.9,1064 L47.1,1063.8 L48.3,1062.8 L50.2,1062.1 L52.3,1061.6 L54.2,1060.6 L56.1,1059.9 L57.1,1060.1 L56.9,1061.3 L57.1,1063.1 L59.4,1063.2 L61,1064 L62.4,1063.5 L63.4,1062.6 L64,1061.6 L63.8,1060 L62.2,1058.7 L63.2,1058.1 L63.7,1056.9 L65,1056.2 L66,1056 L67.5,1055.4 L69.1,1056.3 L70.1,1055.5 L71.3,1054.9 L71.4,1052.8 L72.7,1052.3 L73.7,1052.9 L74.8,1052.5 L74,1051.1 L75,1050.3 L76.1,1050.1 L76.1,1048.9 L77.5,1048.2 L78.1,1046.6 L79.9,1046.7 L81.2,1046.5 L81.5,1045.2 L82.9,1044.9 L84,1043.6 L85.5,1041.4 L85.6,1039.5 L85.9,1038 L86.2,1036.8 L87.2,1036.2 L88.6,1035.3 L89.7,1033.6 L90.4,1032 L90.5,1030.8 L91.5,1029.7 L91.8,1028.5 L93.1,1027.4 L93.6,1026.1 L94.5,1024.8 L95.2,1022.7 L94.1,1021.7 L94.8,1020.6 L95.9,1020.6 L97.5,1020.1 L98.2,1019.1 L99.8,1017.9 L100.1,1016.9 L99.3,1015.9 L100.8,1016.3 L101.9,1015.2 L102.7,1013.6 L103.9,1011.3 L106.5,1007.2 L107.1,1005.7 L108.4,1003.6 L109.1,1001.9 L109.7,1000 L111.8,1000.4 L116.6,1001.1 L117.6,1001.2 L119.4,1000.3 L120.5,999.7 L121.3,998.2 L122.6,997.2 L123.9,996.4 L125.4,995.5 L126.4,996.5 L126.8,997.5 L128.3,998.2 L130.9,998.6 L130.2,1000.8 L129.9,1003.4 L130.1,1004.5 L129.8,1005.9 L130.9,1005.1 L132.6,1005.1 L133.4,1006.1 L135.9,1006.2 L137.2,1006.9 L139.1,1007.5 L140.6,1007.1 L141.9,1007.6 L142.9,1009 L143.4,1010.1 L143.8,1011.3 L144.8,1012.3 L145.7,1013.4 L145.7,1014.8 L148.6,1014.9 L149.9,1014.8 L153.1,1015.1 L156.2,1014.8 L159.8,1015.5 L162.4,1015.7 L164.7,1015.2 L165.8,1013.6 L166.9,1013.5 L168.2,1013.6 L169.8,1013 L172.3,1012.2 L173.7,1012.1 L176,1011.2 L177,1011.1 L178.4,1011.3 L180.2,1011.9 L183.2,1012.2 L185.6,1012.7 L186.8,1013.8 L188.2,1014.2 L190.9,1012.7 L194.4,1010.4 L196.5,1008.8 L197.8,1008 L200.7,1006.3 L203.7,1005 L204.9,1004.6 L206.4,1003.8 L209.7,1001.7 L211.8,1000.2 L213,999.5 L214.6,998.1 L216.6,996 L218.3,994.5 L220.3,992.6 L221.3,992.3 L222.8,992.1 L224.1,992.1 L228.7,992.8 L230,993.4 L232.5,995.9 L233.6,999.1 L234.5,1000.4 L235.5,1001 L237.3,1001.3 L238.6,1002.3 L239.7,1002.7 L239.6,1003.8 L241.4,1004 L242.4,1006.3 L241.8,1008.6 L240.4,1009.2 L239.2,1009.2 L238.1,1008.5 L236.6,1008.4 L234.9,1010.1 L232,1009.5 L230.6,1009.6 L229.6,1010.3 L228.6,1010.7 L229.4,1012.7 L228.7,1015.7 L229.4,1016.9 L230.9,1017.5 L232.7,1015.6 L234.6,1014.8 L235.6,1015.4 L236,1016.4 L236,1017.8 L236.5,1018.9 L237.6,1019 L238.8,1018.5 L239.4,1016.4 L239.2,1014.6 L239.7,1013.6 L241.6,1013.6 L244.6,1012.7 L246.4,1012.7 L247.7,1011.3 L247.6,1009.8 L248.5,1008.6 L249.3,1007 L253.4,1008.4 L254.4,1008.6 L255.7,1007.6 L258,1006.4 L258.9,1005.1 L258.7,1003.4 L260.2,1003.8 L261.2,1004.5 L261.5,1006.7 L262.4,1008.7 L264,1008.9 L265.1,1008.7 L266.5,1007.7 L267.8,1007.7 L268.4,1009.1 L269.2,1007.8 L270.5,1007 L271.2,1008.1 L271.2,1009.4 L272.7,1009.6 L274,1009.4 L275.5,1008.9 L276.6,1010.5 L277.1,1011.9 L278.1,1012.6 L279.3,1010.6 L280.3,1010.6 L282.2,1011.2 L283.5,1011.5 L284.6,1011.4 L285.9,1011.1 L288.6,1011.6 L288.1,1009.1 L288.5,1007.7 L289.5,1006.3 L289.8,1005 L289.7,1001.5 L289.7,999.6 L289.5,998.3 L288.4,998.1 L287.2,998.2 L286.2,996.8 L287.7,995.8 L288.8,994.8 L289.9,994.7 L290.9,996.6 L292.5,995.7 L294.2,995.6 L295.2,996.5 L297.6,996.9 L300,998.3 L301.1,998.7 L302.6,998.9 L304.1,998.8 L304.5,997 L306.1,996 L307.7,996.6 L309.5,998 L310.7,998.9 L311.6,997.8 L312.3,996.3 L312.3,995.1 L312.1,994.1 L313.4,993.3 L314.5,992.9 L315.6,991.5 L316.8,991 L317.9,990.6 L319.4,990.6 L321.2,990.7 L323.5,991.4 L324.9,991.5 L326,991.8 L327.2,992.7 L328.8,992.8 L331.8,993.4 L333.2,994.2 L334.3,994.5 L336.8,994.6 L337.9,994.3 L338.9,993.8 L339.2,992.4 L339.1,991.2 L338.9,989.2 L340.1,989.1 L342.3,987.8 L342.8,986.8 L345.1,985.9 L347.1,985.6 L348.2,985.9 L351.9,987.9 L354.1,986.8 L355.2,984.5 L357.1,984.8 L359.4,984.4 L359.7,982.5 L359,980.4 L359.2,978.7 L362.6,977.9 L363.9,977.5 L364.5,978.7 L366,980.2 L367.4,981.5 L369.2,983.3 L370.8,985 L372.4,986.3 L373.7,987.2 L375.4,988.2 L375.9,989.7 L375.9,990.7 L377.8,992 L377.3,993 L378.8,994.1 L381,995 L382.7,994.4 L383.7,994.7 L383.8,993.4 L383.4,992.4 L384,990.7 L384.3,989.5 L384.3,988.3 L384.2,986.7 L386.4,986 L387.6,986.3 L388.9,987.4 L390.9,987.7 L391.7,986.4 L393.9,986.5 L394.6,985.5 L396.7,983.2 L398,982.7 L400,982.3 L401,981.7 L402.4,980.7 L404.9,979.7 L406.7,979.6 L406.2,980.9 L405.7,982.1 L404.2,982.4 L403.5,983.5 L402.9,984.5 L400.9,986 L400.8,987.1 L402.2,987.7 L404.3,988.6 L405.9,989.5 L407.9,989.2 L409.1,988.9 L410,990.4 L411,990.8 L412,992 L413.4,992.6 L415.2,993.3 L415.4,994.4 L415.3,996 L416.4,996 L419,995.8 L420.2,996.1 L421.7,996.1 L421.6,995.1 L422.5,994.1 L423.9,993 L426,992.7 L427,991.2 L429.8,989.8 L429.9,988.7 L430.8,987.5 L432,987.8 L433,989 L433.1,990.6 L433.8,991.6 L434.8,994.1 L436.3,993.9 L438.5,992.8 L439.8,992 L440.7,990.9 L441.7,990.9 L443.6,989.6 L445.5,987.3 L447.1,986.7 L449.6,985.3 L451,984.1 L451.6,982.4 L452.5,980.6 L454,980.2 L456.5,978.5 L457.5,977.8 L459.8,977.2 L460.8,976.1 L461.7,974.8 L463.2,974.3 L464.4,973.5 L465.9,972.9 L467.1,974.1 L471.1,969.9 L472.5,970.7 L473.6,971 L473.5,972 L474.7,972.5 L475.8,973.1 L476.9,974.2 L477,975.6 L476.2,976.6 L476.9,977.7 L474.9,978.5 L473.9,977.8 L472.8,979.6 L471.8,980.3 L471.7,982 L471.6,983.3 L470.2,983.9 L467.8,985.3 L468.3,984.1 L469.2,983.1 L468.9,982.1 L467.5,982.5 L466.3,983.3 L467.3,983.9 L466.7,984.9 L467.8,986.3 L469.2,987.3 L469.7,988.7 L470.1,990.1 L472.4,989.4 L473.5,989.4 L475,989.5 L476.4,988.7 L477,987.4 L478.2,987 L479.6,987.5 L482.7,984.8 L484.4,983.7 L485.6,982.6 L487.4,984.8 L489.7,982.6 L494.5,983.4 L495.9,982.5 L497,983.5 L497.7,984.5 L499.1,985.4 L500.6,984.7 L502.2,984.9 L503.2,985.5 L503.9,987 L505,988.3 L507.4,989.6 L508.7,990.3 L509.9,990 L512,988.2 L513.4,988.3 L514.5,988.1 L515.9,987.6 L517.3,987.6 L520,986.1 L520,984.6 L520.4,982.7 L520.9,981.2 L522,982 L524.3,982.6 L524.7,981.5 L525.5,979.9 L526.7,977.2 L526.7,975.5 L530.3,975.4 L531.6,974.5 L532.6,974 L534.2,973.4 L536.9,973.5 L536.5,975.5 L537.7,976.1 L539,976 L540.3,975.6 Z',
        fill: '#3b82f6',
        stats: { clients: 85, agents: 30, sites: 40 },
        x: 351, y: 1114
    }
];


// Reusing same departments array structure for paths to keep it simple and encapsulated
const getFillColor = (id: string) => {
    // Custom gradient logic or specific colors per dept can be here
    const dept = departments.find(d => d.id === id);
    return dept ? dept.fill : '#cbd5e1';
};

export function InteractiveMap({ departmentStats }: InteractiveMapProps) {
    // Merge Sanity stats with local SVG path data
    const mergedDepartments = useMemo(() => {
        if (!departmentStats || departmentStats.length === 0) return departments;
        return departments.map(dept => {
            const sanityData = departmentStats.find(d => d.departmentId === dept.id);
            if (sanityData) {
                return {
                    ...dept,
                    name: sanityData.name || dept.name,
                    stats: {
                        clients: sanityData.clients ?? dept.stats.clients,
                        agents: sanityData.agents ?? dept.stats.agents,
                        sites: sanityData.sites ?? dept.stats.sites,
                    },
                };
            }
            return dept;
        });
    }, [departmentStats]);

    // Persistent selection (clicked)
    const [selectedDept, setSelectedDept] = useState<typeof departments[0]>(mergedDepartments[0]);
    // Temporary hover (visual feedback)
    const [hoveredDept, setHoveredDept] = useState<typeof departments[0] | null>(null);

    // activeDept determines what is currently shown.
    // Logic: If hovering something, show that. If not, show what is selected.
    const displayDept = hoveredDept || selectedDept;

    const handleMouseEnter = (dept: typeof departments[0]) => {
        setHoveredDept(dept);
    };

    const handleMouseLeave = () => {
        setHoveredDept(null);
    };

    const handleClick = (dept: typeof departments[0]) => {
        setSelectedDept(dept);
    };

    const getDeptFill = (dept: typeof departments[0]) => {
        // If this department is the one persistently selected (clicked), it gets the Orange Accent color.
        if (selectedDept.id === dept.id) {
            return '#FF6B35'; // Brand Accent Orange
        }
        // Otherwise, return its default color
        return getFillColor(dept.id);
    };

    return (
        <section className="py-20 bg-white dark:bg-black overflow-hidden relative">
            <div className="container-custom relative z-10">
                <div className="text-center mb-12">
                    <h2 className="text-primary dark:text-primary-light font-bold tracking-wide uppercase text-sm mb-2">
                        Notre Rayonnement
                    </h2>
                    <h3 className="text-3xl md:text-5xl font-bold text-gray-900 dark:text-white">
                        Nouvelle-Aquitaine
                    </h3>
                </div>

                <div className="grid lg:grid-cols-12 gap-8 items-center">
                    {/* SVG Map Container */}
                    <div className="lg:col-span-7 flex items-center justify-center p-4" onMouseLeave={handleMouseLeave}>
                        <svg
                            viewBox="0 0 1151 1402"
                            className="w-full h-auto max-h-[600px] drop-shadow-xl"
                            style={{ filter: 'drop-shadow(0 10px 20px rgba(0,0,0,0.15))' }}
                        >
                            {mergedDepartments.map((dept) => {
                                // Is this department currently the one being displayed/highlighted?
                                const isHighlighted = displayDept.id === dept.id;
                                // Is this department the one permanently selected?
                                const isSelected = selectedDept.id === dept.id;

                                return (
                                    <g key={dept.id}>
                                        <path
                                            d={dept.path}
                                            className={clsx(
                                                "cursor-pointer transition-all duration-300 stroke-white stroke-[2px]",
                                                isHighlighted
                                                    ? "opacity-100 scale-[1.02] z-10 brightness-110"
                                                    : "opacity-90 hover:opacity-100"
                                            )}
                                            fill={getDeptFill(dept)}
                                            style={{ transformOrigin: 'center' }}
                                            onMouseEnter={() => handleMouseEnter(dept)}
                                            onMouseLeave={handleMouseLeave}
                                            onClick={() => handleClick(dept)}
                                        />
                                        {/* Department Number Label */}
                                        <text
                                            x={dept.x}
                                            y={dept.y}
                                            textAnchor="middle"
                                            dominantBaseline="central"
                                            className={clsx(
                                                "pointer-events-none font-bold fill-white/80 transition-all duration-300 select-none",
                                                isHighlighted ? "text-4xl fill-white" : "text-2xl"
                                            )}
                                            style={{
                                                fontSize: isHighlighted ? '4rem' : '2.5rem',
                                                textShadow: '0 2px 4px rgba(0,0,0,0.2)'
                                            }}
                                        >
                                            {dept.id}
                                        </text>
                                    </g>
                                );
                            })}
                        </svg>
                    </div>

                    {/* Info Card - Simplified/Clean */}
                    <div className="lg:col-span-5">
                        <AnimatePresence mode="wait">
                            <motion.div
                                key={displayDept.id}
                                initial={{ opacity: 0, x: 20 }}
                                animate={{ opacity: 1, x: 0 }}
                                exit={{ opacity: 0, x: -20 }}
                                transition={{ duration: 0.2 }}
                                className="bg-gray-50 dark:bg-neutral-900 rounded-3xl p-8 border border-gray-100 dark:border-neutral-800"
                            >
                                <div className="flex items-center justify-between mb-6">
                                    <h3 className="text-3xl font-bold text-gray-900 dark:text-white">
                                        {displayDept.name}
                                    </h3>
                                    <span className="text-6xl font-bold text-gray-500 dark:text-gray-400 tabular-nums tracking-tighter">
                                        {displayDept.id}
                                    </span>
                                </div>

                                <div className="space-y-4">
                                    {/* Sites */}
                                    <div className="flex justify-between items-center p-4 bg-white dark:bg-neutral-800 rounded-xl shadow-sm">
                                        <div className="flex items-center gap-3">
                                            <div className="p-2 bg-blue-100 dark:bg-blue-900/30 text-blue-600 rounded-lg">
                                                <Shield size={20} />
                                            </div>
                                            <div className="flex flex-col">
                                                <span className="font-medium text-gray-900 dark:text-gray-100">Sites protégés</span>
                                                <span className="text-xs text-gray-700 dark:text-gray-400">Actifs 24/7</span>
                                            </div>
                                        </div>
                                        <span className="text-xl font-bold text-gray-900 dark:text-white">{displayDept.stats.sites}</span>
                                    </div>

                                    {/* Agents */}
                                    <div className="flex justify-between items-center p-4 bg-white dark:bg-neutral-800 rounded-xl shadow-sm">
                                        <div className="flex items-center gap-3">
                                            <div className="p-2 bg-green-100 dark:bg-green-900/30 text-green-600 rounded-lg">
                                                <Users size={20} />
                                            </div>
                                            <div className="flex flex-col">
                                                <span className="font-medium text-gray-900 dark:text-gray-100">Agents mobilisables</span>
                                                <span className="text-xs text-gray-700 dark:text-gray-400">Intervention rapide</span>
                                            </div>
                                        </div>
                                        <span className="text-xl font-bold text-gray-900 dark:text-white">{displayDept.stats.agents}</span>
                                    </div>

                                    {/* Clients */}
                                    <div className="flex justify-between items-center p-4 bg-white dark:bg-neutral-800 rounded-xl shadow-sm">
                                        <div className="flex items-center gap-3">
                                            <div className="p-2 bg-purple-100 dark:bg-purple-900/30 text-purple-600 rounded-lg">
                                                <Activity size={20} />
                                            </div>
                                            <div className="flex flex-col">
                                                <span className="font-medium text-gray-900 dark:text-gray-100">Clients satisfaits</span>
                                                <span className="text-xs text-gray-700 dark:text-gray-400">Dans ce secteur</span>
                                            </div>
                                        </div>
                                        <span className="text-xl font-bold text-gray-900 dark:text-white">{displayDept.stats.clients}</span>
                                    </div>
                                </div>

                                <div className="mt-8">
                                    <Link
                                        href={`/devis?location=${displayDept.id}#formulaire-devis`}
                                        className="w-full relative overflow-hidden rounded-xl group block"
                                        aria-label={`Demander un devis pour ${displayDept.name} (${displayDept.id})`}
                                    >
                                        <div
                                            className="absolute inset-0 opacity-10 group-hover:opacity-20 transition-opacity"
                                            style={{ backgroundColor: getDeptFill(displayDept) }}
                                        />
                                        <div
                                            className="w-full py-4 rounded-xl font-bold transition-all flex items-center justify-center gap-2 group-hover:gap-3 text-gray-900 bg-[#FF6B35] hover:bg-[#ff8559] shadow-lg relative z-10 cursor-pointer"
                                        >
                                            Demander un devis
                                            <ArrowRight className="w-5 h-5" />
                                        </div>
                                    </Link>
                                </div>
                            </motion.div>
                        </AnimatePresence>
                    </div>
                </div>
            </div>
        </section >
    );
}
